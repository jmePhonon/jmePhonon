apply plugin : 'java' 


def jmerepo='com.github.jmonkeyengine.jMonkeyEngine'
def jmeversion='v3.2.0-stable'

repositories {
    mavenCentral()
    maven { url 'https://jitpack.io' }
    
}

dependencies {
    compile jmerepo + ':jme3-core:' + jmeversion
    compile jmerepo + ':jme3-desktop:' + jmeversion
    compile jmerepo + ':jme3-lwjgl:' + jmeversion
    compile jmerepo + ':jme3-jogg:' + jmeversion
    testCompile 'junit:junit:4.11'

}

sourceSets{
main {   
    resources {
        srcDir 'build/natives/'
    }
}


test {   
    java{
        srcDir "src/test/unit"
    }
    resources {
        srcDir 'build/natives/'
    }
}

}


task buildNativeTests(type :Exec){
    commandLine 'bash','premake.sh',"buildNativeTests"
}

task premake(type :Exec){
    commandLine 'bash','premake.sh'
}

// task premakeClean(type :Exec){
//     commandLine 'bash','premake.sh','clean'
// }
// clean.dependsOn(premakeClean)



task buildNatives(type :Exec){
    commandLine 'bash','premake.sh',"buildNatives"
}
// buildNatives.dependsOn(clean)
buildNatives.finalizedBy(build)

task updateJNIHeaders(type:Exec) {
    def classpath = configurations.compile.join(":")+ ":build/classes/java/main";
    commandLine 'bash','premake.sh',"updateJNIHeaders",classpath,"build/classes/java/main","src/main/natives/include"
    dependsOn classes
}

build.dependsOn(premake)